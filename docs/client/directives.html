<!DOCTYPE html>

<html>
<head>
  <title>directives.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="config.html">
                config.js
              </a>
            
              
              <a class="source" href="directives.html">
                directives.js
              </a>
            
              
              <a class="source" href="ColorIndexService.html">
                ColorIndexService.js
              </a>
            
              
              <a class="source" href="HomeController.html">
                HomeController.js
              </a>
            
              
              <a class="source" href="MultiplayerController.html">
                MultiplayerController.js
              </a>
            
              
              <a class="source" href="ScoreService.html">
                ScoreService.js
              </a>
            
              
              <a class="source" href="TimeService.html">
                TimeService.js
              </a>
            
              
              <a class="source" href="index.html">
                index.js
              </a>
            
              
              <a class="source" href="LoginController.html">
                LoginController.js
              </a>
            
              
              <a class="source" href="main.html">
                main.js
              </a>
            
              
              <a class="source" href="ProfileController.html">
                ProfileController.js
              </a>
            
              
              <a class="source" href="ResultsController.html">
                ResultsController.js
              </a>
            
              
              <a class="source" href="ResultsService.html">
                ResultsService.js
              </a>
            
              
              <a class="source" href="services.html">
                services.js
              </a>
            
              
              <a class="source" href="SignUpController.html">
                SignUpController.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>directives.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>angular.module(<span class="hljs-string">'app.directives'</span>, [])</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>d3 directive to use it in profile and results page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>.directive(<span class="hljs-string">'d3'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$timeout</span>)</span>{
  <span class="hljs-keyword">return</span>{
    replace: <span class="hljs-literal">true</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>directive has its own scope, and we pass in parameters from the container’s controller scope</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    scope:{
      margin:<span class="hljs-string">"="</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>width:”=”,</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      height:<span class="hljs-string">"="</span>,
      control: <span class="hljs-string">"=control"</span>
    },
    link: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">scope, element</span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>control is an object that enables the controller to access methods in the directive.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>       scope.internalControl = scope.control || {};</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>initialize the width height and margins of the chart</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>       <span class="hljs-keyword">var</span> width = element[<span class="hljs-number">0</span>].offsetWidth;
       <span class="hljs-keyword">var</span> height = scope.height;
       <span class="hljs-keyword">var</span> margin = scope.margin;</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>create the svg for the chart</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> svg = d3.select(element[<span class="hljs-number">0</span>]).append(<span class="hljs-string">"svg"</span>)
      .attr(<span class="hljs-string">"width"</span>, width)
      .attr(<span class="hljs-string">"height"</span>, height)
    .append(<span class="hljs-string">"g"</span>)
      .attr(<span class="hljs-string">"class"</span>, <span class="hljs-string">"graph"</span>)
      .attr(<span class="hljs-string">"transform"</span>, <span class="hljs-string">"translate("</span> + margin.left  + <span class="hljs-string">","</span> + margin.top + <span class="hljs-string">")"</span>);    


      scope.internalControl.createGraph = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data, yLabel</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>x goes all the way but subtracting the margin and a constant offset for more space.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">var</span> x = d3.scale.linear()
            .range([<span class="hljs-number">0</span>, width-margin.left - <span class="hljs-number">10</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>y goes all the way, subtracting constant offset for space</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">var</span> y = d3.scale.linear()
            .range([height-<span class="hljs-number">40</span>, <span class="hljs-number">0</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>create xAxis</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">var</span> xAxis = d3.svg.axis()
            .scale(x)
            .orient(<span class="hljs-string">"bottom"</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>create yAxis</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">var</span> yAxis = d3.svg.axis()
            .scale(y)
            .orient(<span class="hljs-string">"left"</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>create the line that we’ll use to join our data points</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">var</span> line = d3.svg.line()
            .x(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> x(d.increment); })
            .y(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> y(d.point); });</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>setting x and y domains</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          x.domain(d3.extent(data, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.increment; }));
          y.domain(d3.extent(data, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">d</span>) </span>{ <span class="hljs-keyword">return</span> d.point; }));

          $timeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>appending the xAxis to the svg</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              svg.append(<span class="hljs-string">"g"</span>)
                  .attr(<span class="hljs-string">"class"</span>, <span class="hljs-string">"x axis horizontal"</span>)
                  .transition()
                    .duration(<span class="hljs-number">1500</span>)
                    .attr(<span class="hljs-string">"transform"</span>, <span class="hljs-string">"translate(0,"</span> + (height-<span class="hljs-number">30</span>) + <span class="hljs-string">")"</span>)
                    .call(xAxis);</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>appending the yAxis to the svg</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              svg.append(<span class="hljs-string">"g"</span>)
                  .transition()
                    .duration(<span class="hljs-number">1500</span>)
                    .attr(<span class="hljs-string">"class"</span>, <span class="hljs-string">"y axis vertical"</span>)
                    .call(yAxis);</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>appending the yLabel to the svg</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              svg.append(<span class="hljs-string">"text"</span>)
                  .transition()
                    .duration(<span class="hljs-number">1500</span>)
                    .attr(<span class="hljs-string">"class"</span>, <span class="hljs-string">"y label"</span>)
                    .attr(<span class="hljs-string">"transform"</span>, <span class="hljs-string">"rotate(-90)"</span>)
                    .attr(<span class="hljs-string">"y"</span>, - margin.left)
                    .attr(<span class="hljs-string">"x"</span>, -<span class="hljs-number">50</span>)
                    .attr(<span class="hljs-string">"dy"</span>, <span class="hljs-string">".71em"</span>)
                    .style(<span class="hljs-string">"text-anchor"</span>, <span class="hljs-string">"end"</span>)
                    .text(yLabel);</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>appending the path to the svg</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>              svg.append(<span class="hljs-string">"path"</span>)
                .datum(data)
                .attr(<span class="hljs-string">"class"</span>, <span class="hljs-string">"line"</span>)
                .transition()
                  .duration(<span class="hljs-number">1500</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>.style(“stroke-opacity”, 1e-6)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                  .style(<span class="hljs-string">"stroke-opacity"</span>, <span class="hljs-number">1</span>)
                  .attr(<span class="hljs-string">"d"</span>, line);

          }, <span class="hljs-number">1</span>);
      };

      scope.internalControl.removeGraph = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>removing the chart (animated)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $timeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>select the graph</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">var</span> graph = d3.select(<span class="hljs-string">"svg"</span>).select(<span class="hljs-string">".graph"</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>animate removal of xAxis</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          graph.select(<span class="hljs-string">'g.horizontal'</span>)
            .transition()
              .duration(<span class="hljs-number">1500</span>)
              .attr(<span class="hljs-string">"transform"</span>, <span class="hljs-string">"translate("</span> + width + <span class="hljs-string">","</span> + height + <span class="hljs-string">")"</span>)
              .style(<span class="hljs-string">"fill-opacity"</span>, <span class="hljs-number">1e-6</span>)
              .style(<span class="hljs-string">"stroke-opacity"</span>, <span class="hljs-number">1e-6</span>)
              .remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>animate removal of yAxis</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          graph.select(<span class="hljs-string">'g.vertical'</span>)
            .transition()
              .duration(<span class="hljs-number">1500</span>)
              .attr(<span class="hljs-string">"transform"</span>, <span class="hljs-string">"translate(0,"</span> + height + <span class="hljs-string">")"</span>)
              .style(<span class="hljs-string">"fill-opacity"</span>, <span class="hljs-number">1e-6</span>)
              .style(<span class="hljs-string">"stroke-opacity"</span>, <span class="hljs-number">1e-6</span>)
              .remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>remove yaxis label</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          graph.select(<span class="hljs-string">'.label'</span>).remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>animate removal of the line/path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          graph.select(<span class="hljs-string">'path.line'</span>)
            .transition()
              .duration(<span class="hljs-number">1500</span>)
              .attr(<span class="hljs-string">"transform"</span>, <span class="hljs-string">"translate("</span> + width + <span class="hljs-string">", 0)"</span>)
              .style(<span class="hljs-string">"stroke-opacity"</span>, <span class="hljs-number">1e-6</span>)
              .remove();
        }, <span class="hljs-number">1</span>);

      };</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>this tells the controller that the directive finished loading, and thus
you can start calling these methods from the controller.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      scope.internalControl.loaded();

    }
  };
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
